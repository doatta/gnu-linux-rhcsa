На основе исходного кода Red Hat Enterprise Linux (RHEL) создаётся полностью совместимый, бесплатный дистрибутив Centos (Community ENTerprise Operating System). Именно его мы будем использовать для подготовки к сертификации от Red Hat.

Centos можно скачать с сайта [centos.org](https://centos.org/), как с помощью прямой [ссылки](http://isoredirect.centos.org/centos/8/isos/x86_64/), так и при помощи торрента. У проекта сейчас 2 подхода к обновлениям – придерживаться строгой совместимости с RHEL(CentOS Linux), либо, при помощи сообщества, добавлять в дистрибутив новые пакеты и патчи(CentOS Stream), чем пользуется Red Hat в качестве тестовой площадки. Для обучения подойдёт любой из двух вариантов, но, на всякий случай, стоит использовать первый вариант.

![](images/3/centos.png)

Дальше мы можем скачать образ DVD диска на 7 гигабайт, в котором есть весь необходимый для установки софт, либо минимальный образ на 600 мегабайт, который, при установке, будет докачивать необходимое из интернета. Так как я буду устанавливать систему несколько раз - с графическим интерфейсом, без графического интерфейса и т.д. - я скачиваю DVD образ на 7 гигабайт. 

![](images/3/0.download.png)

![](images/3/1.newvm.png)

![](images/3/2.cent.png)

После того как всё скачается, запускаем VirtualBox и создаём новую виртуальную машину. Если в названии указать “Cen”, то программа сама предложит тип операционной системы (Linux) и версию (Red Hat (64 bit)). Дальше указываем количество оперативной памяти для виртуальной машины. Минимальное значение – 2 гигабайта, но, в дальнейшем, без графического интерфейса, можно обойтись и меньшими параметрами.

![](images/3/3.vdi.png)

Дальше выбираем “Создать виртуальный диск”, так как он нам нужен для операционной системы, а готового диска у нас нет. После этого указываем тип диска, в зависимости от того, будет ли нам нужно этот виртуальный диск переносить на другие платформы или нет. Так как мы этого не планируем, выбираем VDI – родной формат для VirtualBox. Дальше выбираем, как наш виртуальный диск займёт пространство на нашем реальном диске. Тут два варианта – либо мы даём виртуальной машине диск с каким-то виртуальным размером, реальный размер которого будет изменяться в зависимости от действительно занятого пространства, либо мы сразу выделяем место для виртуального диска, после чего это место станет недоступно для хоста, независимо от того, есть там данные или нет. Есть небольшая разница в производительности в пользу фиксированного размера, но динамический метод оставляет больше места на компьютере. Часто такие подходы к выделению пространства называют thin и thick provisioning соответственно. После этого выбираем, где будет храниться виртуальный диск и его объём. Объём зависит от количества устанавливаемых программ и хранимых файлов. При минимальной установке желательно давать объём не меньше 8 гигабайт, а в нашем случае я укажу 20 гигабайт, которых хватит с запасом.  

![](images/3/4.set.png)

После нажатия Create кликаем правой кнопкой мыши на появившейся виртуальной машине и заходим в настройки. 

![](images/3/5.clipb.png)

Во вкладке General – Advanced – Shared Clipboard выставляем значение Bidirectional, что позволит копировать текст между хостом и виртуалкой, то есть создаст общий буфер обмена.

![](images/3/6.video.png)

Во вкладке Display – Screen - Video Memory повышаем значение до 64 Мб или выше, так как при малых значениях графический интерфейс виртуальной машины может подвисать.

![](images/3/7.bridge.png)

Во вкладке Network – Adapter 1 меняем Attached to: NAT на Bridged Adapter и указываем сетевой адаптер, к которому подсоединена сеть на нашем компьютере, что позволит виртуальной машине быть в той же сети, что и хост.

![](images/3/8.start.png)

После этого нажимаем OK и Start, что запускает виртуальную машину.

![](images/3/9.image.png)

VirtualBox предложит указать образ, с которого будет установлена операционная система. В появившемся окне выбираем Add и указываем ISO файл Centos-а, который мы скачали. Дальше выбираем этот образ и нажимаем Choose.

![](images/3/10.test.png)

В новом окне появится меню, где по умолчанию выделено “Test this media”. Эта опция начнёт проверять установщик на целостность, что занимает время. Выберите опцию “Install CentOS Linux 8” (стрелка вверх) и нажмите Enter. Затем загрузится графический установщик, в котором можно работать мышкой.

![](images/3/11.capture.png)

Если вы попытаетесь нажать на экран, VirtualBox предупредит вас, что виртуальная машина перехватит вашу мышку, из-за чего вы не сможете использовать её на хосте. Это не проблема, потому что когда вам понадобится, вы можете нажать правый Ctrl и освободить мышку, поэтому нажимаем Capture.

![](images/3/12.lang.png)

Когда дело касается языка установщика или операционной системы, рекомендую использовать Английский (US). Очень важно знать IT терминологию на английском языке, а также это позволит вам избежать дальнейших недопониманий. Теперь давайте пройдёмся по настройкам.

![](images/3/13.menu.png) 
![](images/3/13.keyboard.png)
![](images/3/13.options.png)

В меню Keyboard добавляем нужную раскладку и выбираем горячие клавиши для переключения раскладки.

![](images/3/14.menu.png)
![](images/3/14.network.png)

В меню Network & Host Name включаем сетевой адаптер, чтобы появилась сеть и указываем имя компьютеру.

![](images/3/15.menu.png)
![](images/3/15.time.png)

Во вкладке Time & Date убеждаемся, что включён Network Time и указываем правильную временную зону.

![](images/3/16.menu.png)
![](images/3/16.soft.png)

Во вкладке Software Selection выбираем Workstation и ставим галочки перед теми пакетами программ, которые мы хотели бы установить.

![](images/3/17.menu.png)
![](images/3/17.disk.png)

Заходим во вкладку Installation Destination и просто нажимаем Done, установщик сам разметит диск. Я не буду рассматривать вопрос разметки диска сейчас, так как это требует понимания многих тем, которые мы еще не прошли. 

![](images/3/18.begin.png)

Нажимаем Begin Installation. 

Пока идёт установка, мы должны задать пароль пользователю root и создать пользователя.

![](images/3/19.root.png)

![](images/3/19.rootp.png)

root – это пользователь, у которого есть все права на систему, он может делать с операционной системой практически всё.

![](images/3/19.user.png)
![](images/3/19.userp.png)

Дальше создаём пользователя и ставим галочку “Сделать этого пользователя администратором”. И хотя у нас есть пользователь root с полными правами на систему, безопаснее использовать пользователя с административными правами.

![](images/3/20.finish.png)

Затем дожидаемся конца установки системы.

![](images/3/20.eject.png)
![](images/3/20.reboot.png)

После установки следует отмонтировать ISO образ и перезагрузить виртуалку (Devices – Optical Drive – убираем галочку с установочного образа, затем Machine – Reset для перезагрузки). 

![](images/3/21.license.png)
![](images/3/21.license2.png)
![](images/3/21.license3.png)

При включении принимаем лицензионное соглашение.

![](images/3/22.user.png)
![](images/3/22.password.png)
![](images/3/22.gnome.png)
![](images/3/22.gnome2.png)

Затем логинимся пользователем user, после чего рабочее окружение, называемое Gnome, спросит у нас пару настроек и покажет окно с возможностями. Советую ознакомиться с ними.

![](images/3/23.terminal.png)
![](images/3/23.updates.png)

Дальше стоит установить обновления – для этого нажимаем Activities – Terminal и в терминале вводим команду (sudo dnf update -y), после чего терминал спросит пароль пользователя. Введённый пароль не будет отображаться даже звёздочками, поэтому просто введите пароль и нажмите Enter. Эта команда обновит нашу систему.

```
sudo dnf update -y
```

![](images/3/23.updatescomplete.png)

Иногда, при сбоях с сетью, команда может выдать ошибку, поэтому стоит прочитать последние строчки. Если вы видите там error или что-то в этом духе, то попробуйте заново запустить предыдущую команду. Если Complete – значит всё нормально. 

![](images/3/24.install.png)

После обновления нужно установить пару программ (sudo dnf install kernel-devel kernel-headers elfutils-libelf-devel gcc make perl -y). Это нужно для дальнейшей установки гостевых утилит - драйверов и утилит, необходимых виртуальной операционной системе для работы с гипервизором. Без них виртуалка тоже работает, но некоторые функции будут работать неполноценно - не будет определяться разрешение экрана, не будет общего буфера обмена и т.п. На продвинутых гипервизорах такие дополнения могут показывать на хосте детальную информацию об операционной системе виртуалки и даже управлять ей.

```
sudo dnf install kernel-devel kernel-headers elfutils-libelf-devel gcc make perl -y
```

![](images/3/25.reboot1.png)
![](images/3/25.reboot2.png)

После того как успешно выполнилась предыдущая команда, перезагружаем виртуальную машину, затем снова логинимся нашим пользователем. 

![](images/3/26.guest.png)
![](images/3/26.download.png)
![](images/3/26.download2.png)

Дальше, в окне VirtualBox-а в меню Devices выбираем Insert Guest Additions CD Image, скачиваем необходимый образ диска.

![](images/3/26.insert.png)
![](images/3/26.run.png)
![](images/3/26.pass.png)

После этого диск подключится к виртуалке, где мы сможем нажать Run и программа установит гостевые утилиты.

![](images/3/27.reboot.png)

Когда в новом терминале появится надпись “Press Return to close this window”, нужно ещё раз перезагрузить компьютер. На этот раз операционная система правильно определит размер экрана и подстроится под размер окна VirtualBox.

![](images/3/28.gui.png)

Советую вам потыкать настройки и программы, чтобы ближе познакомиться с графическим интерфейсом. А чтобы не пришлось переустанавливать систему после того, как вы случайно что-то сломаете, давайте сделаем снимок. Это функция гипервизора позволяет сохранить текущее состояние виртуальной машины, что позволит в дальнейшем откатиться в к этому состоянию.

![](images/3/29.snapshot.png)
![](images/3/29.take.png)

Для этого нажимаем на значок рядом с виртуальной машиной (Tools), выбираем Snapshots, нажимаем Take и указываем название и описание.

![](images/3/30.restore.png)

Снапшотов может быть несколько, чтобы откатиться к какому-то состоянию – выключаем виртуалку, выбираем снапшот и нажимаем restore.
